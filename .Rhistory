# arrumar o destino aqui
name = paste0(path_workflow, "/outputs/Precipitation_variables_", km, ".pdf")
)
}
for (km in seq_along(buffer_area_list)) {
# Buffer Area -------------------------------------------------------------
path_workflow <- paste0("data/workflow_maxent")
km <- buffer_area_list[[km]]
path_cal <- paste0(path_workflow, "/km_", km)
occ <- read.csv(
paste0(
path_workflow, "/", sp_name, "_train.csv"
)
)
list_file_current <-
list.files(
path = paste0(path_cal, "/Calibration_area_", km),
pattern = "\\.asc$", full.names = T
)
varsm <-
stack(list_file_current)
# Pearson Correlation  ----------------------------------------------------
temp <- stack(
varsm$bio1, varsm$bio2, varsm$bio3, varsm$bio4,
varsm$bio5, varsm$bio6, varsm$bio7, varsm$bio8,
varsm$bio9, varsm$bio10, varsm$bio11
)
prec <- stack(
varsm$bio12, varsm$bio13, varsm$bio14, varsm$bio15,
varsm$bio16, varsm$bio17, varsm$bio18, varsm$bio19
)
## only temperature variables
explore_espace(
data = occ, species = "species", longitude = "longitude",
latitude = "latitude", raster_layers = temp, save = T,
# arrumar o destino aqui
name = paste0(path_workflow, "/output/Temperature_variables_", km, ".pdf")
)
## only precipitation variables
explore_espace(
data = occ, species = "species", longitude = "longitude",
latitude = "latitude", raster_layers = prec, save = T,
# arrumar o destino aqui
name = paste0(path_workflow, "/output/Precipitation_variables_", km, ".pdf")
)
}
for (km in seq_along(buffer_area_list)) {
# Buffer Area -------------------------------------------------------------
path_workflow <- paste0("data/workflow_maxent")
km <- buffer_area_list[[km]]
path_cal <- paste0(path_workflow, "/km_", km)
occ <- read.csv(
paste0(
path_workflow, "/", sp_name, "_train.csv"
)
)
list_file_current <-
list.files(
path = paste0(path_cal, "/Calibration_area_", km),
pattern = "\\.asc$", full.names = T
)
varsm <-
stack(list_file_current)
# Pearson Correlation  ----------------------------------------------------
temp <- stack(
varsm$bio1, varsm$bio2, varsm$bio3, varsm$bio4,
varsm$bio5, varsm$bio6, varsm$bio7, varsm$bio8,
varsm$bio9, varsm$bio10, varsm$bio11
)
prec <- stack(
varsm$bio12, varsm$bio13, varsm$bio14, varsm$bio15,
varsm$bio16, varsm$bio17, varsm$bio18, varsm$bio19
)
dir_create('output')
## only temperature variables
explore_espace(
data = occ, species = "species", longitude = "longitude",
latitude = "latitude", raster_layers = temp, save = T,
# arrumar o destino aqui
name = paste0(path_workflow, "/output/Temperature_variables_", km, ".pdf")
)
## only precipitation variables
explore_espace(
data = occ, species = "species", longitude = "longitude",
latitude = "latitude", raster_layers = prec, save = T,
# arrumar o destino aqui
name = paste0(path_workflow, "/output/Precipitation_variables_", km, ".pdf")
)
}
path_workflow
paste0(path_workflow, "/output/Temperature_variables_", km, ".pdf")
getwd()
path_workflow
source("src/utils/functions.R")
source("src/utils/libraries.R")
sp_name <- "dhominis"
buffer_area_list <- c(100, 200, 250, 300, 400)
neotropic <-
readOGR(
dsn = ("data/layers/Current"),
layer = "neotropic",
verbose = FALSE
)
for (km in seq_along(buffer_area_list)) {
# Buffer Area -------------------------------------------------------------
path_workflow <- paste0("data/workflow_maxent")
km <- buffer_area_list[[km]]
path_cal <- paste0(path_workflow, "/km_", km)
occ <- read.csv(
paste0(
path_workflow, "/", sp_name, "_train.csv"
)
)
list_file_current <-
list.files(
path = paste0(path_cal, "/Calibration_area_", km),
pattern = "\\.asc$", full.names = T
)
varsm <-
stack(list_file_current)
# Pearson Correlation  ----------------------------------------------------
temp <- stack(
varsm$bio1, varsm$bio2, varsm$bio3, varsm$bio4,
varsm$bio5, varsm$bio6, varsm$bio7, varsm$bio8,
varsm$bio9, varsm$bio10, varsm$bio11
)
prec <- stack(
varsm$bio12, varsm$bio13, varsm$bio14, varsm$bio15,
varsm$bio16, varsm$bio17, varsm$bio18, varsm$bio19
)
dir_create('output')
## only temperature variables
explore_espace(
data = occ, species = "species", longitude = "longitude",
latitude = "latitude", raster_layers = temp, save = T,
name = paste0(path_workflow, "/output/Temperature_variables_", km, ".pdf")
)
## only precipitation variables
explore_espace(
data = occ, species = "species", longitude = "longitude",
latitude = "latitude", raster_layers = prec, save = T,
name = paste0(path_workflow, "/output/Precipitation_variables_", km, ".pdf")
)
}
for (km in seq_along(buffer_area_list)) {
# Buffer Area -------------------------------------------------------------
path_workflow <- paste0("data/workflow_maxent")
km <- buffer_area_list[[km]]
path_calibration <- paste0(path_workflow, "/km_", km)
occ <- read.csv(
paste0(
path_workflow, "/", sp_name, "_train.csv"
)
)
list_file_current <-
list.files(
path = paste0(path_calibration, "/Calibration_area_", km),
pattern = "\\.asc$", full.names = T
)
varsm <-
stack(list_file_current)
# Pearson Correlation  ----------------------------------------------------
temp <- stack(
varsm$bio1, varsm$bio2, varsm$bio3, varsm$bio4,
varsm$bio5, varsm$bio6, varsm$bio7, varsm$bio8,
varsm$bio9, varsm$bio10, varsm$bio11
)
prec <- stack(
varsm$bio12, varsm$bio13, varsm$bio14, varsm$bio15,
varsm$bio16, varsm$bio17, varsm$bio18, varsm$bio19
)
dir_create(paste0(path_workflow,'output'))
## only temperature variables
explore_espace(
data = occ, species = "species", longitude = "longitude",
latitude = "latitude", raster_layers = temp, save = T,
name = paste0(path_workflow, "/output/Temperature_variables_", km, ".pdf")
)
## only precipitation variables
explore_espace(
data = occ, species = "species", longitude = "longitude",
latitude = "latitude", raster_layers = prec, save = T,
name = paste0(path_workflow, "/output/Precipitation_variables_", km, ".pdf")
)
}
for (km in seq_along(buffer_area_list)) {
# Buffer Area -------------------------------------------------------------
path_workflow <- paste0("data/workflow_maxent")
km <- buffer_area_list[[km]]
path_calibration <- paste0(path_workflow, "/km_", km)
occ <- read.csv(
paste0(
path_workflow, "/", sp_name, "_train.csv"
)
)
list_file_current <-
list.files(
path = paste0(path_calibration, "/Calibration_area_", km),
pattern = "\\.asc$", full.names = T
)
varsm <-
stack(list_file_current)
# Pearson Correlation  ----------------------------------------------------
temp <- stack(
varsm$bio1, varsm$bio2, varsm$bio3, varsm$bio4,
varsm$bio5, varsm$bio6, varsm$bio7, varsm$bio8,
varsm$bio9, varsm$bio10, varsm$bio11
)
prec <- stack(
varsm$bio12, varsm$bio13, varsm$bio14, varsm$bio15,
varsm$bio16, varsm$bio17, varsm$bio18, varsm$bio19
)
dir_create(paste0(path_workflow,'/output'))
## only temperature variables
explore_espace(
data = occ, species = "species", longitude = "longitude",
latitude = "latitude", raster_layers = temp, save = T,
name = paste0(path_workflow, "/output/Temperature_variables_", km, ".pdf")
)
## only precipitation variables
explore_espace(
data = occ, species = "species", longitude = "longitude",
latitude = "latitude", raster_layers = prec, save = T,
name = paste0(path_workflow, "/output/Precipitation_variables_", km, ".pdf")
)
}
source("src/utils/functions.R")
source("src/utils/libraries.R")
data <- read_excel('data/selected_variables.xlsx') %>%
mutate(across(2:6, char_to_list, .names = "{.col}"))
species_list <- data$species
path_calibration
source("src/utils/functions.R")
source("src/utils/libraries.R")
data <- read_excel('data/selected_variables.xlsx') %>%
mutate(across(2:6, char_to_list, .names = "{.col}"))
data
species_list <- data$species
buffer_area_list <- colnames(data)[2:6]
neotropic <-
readOGR(
dsn = ("data/raw/raster"),
layer = "Neotropic",
verbose = FALSE
)
neotropic <-
readOGR(
dsn = ("data/shapefile/neotropic"),
layer = "Neotropic",
verbose = FALSE
)
for (km in seq_along(buffer_area_list)) {
# Buffer Area -------------------------------------------------------------
path_workflow <- paste0("data/workflow_maxent/")
km <- buffer_area_list[[km]]
path_calibration <- paste0(path_workflow, "/km_", km)
# low corr
loc_variables <- data %>%
dplyr::filter(species == sp_name) %>%
dplyr::select(km)
flat_list <- as.numeric(unlist(loc_variables[[1]]))
# Workflow Kuenm -> Model Calibration -------------------------------------
dir_create(
paste0(
path_calibration,
"/Model_calibration"
)
)
dir_create(
paste0(
path_calibration, "/Model_calibration/M_variables"
)
)
dir_create(
paste0(
path_calibration, "/Model_calibration/M_variables/Set_1"
)
)
file.copy(
from = paste0(path_calibration, "/Calibration_area_", km, "/bio", flat_list, ".asc"),
to = paste0(path_calibration, "/Model_calibration/M_variables/Set_1/bio", flat_list, ".asc")
)
#------------------Principal component analysis and projections-----------------
layers_list <-
c(
"Current",
"future_layer_can_126_60", "future_layer_can_585_60",
"future_layer_mc_126_60", "future_layer_mc_585_60"
)
# PCA and projections
dir_create(paste0(path_calibration,"/pca_", km))
dir_create(paste0(path_calibration,"/pca_", km, "/pca_referenceLayers"))
dir_create(paste0(path_calibration,"/pca_", km, "/pca_proj"))
# dir_create(paste0("G_Variables/Set_2"))
for (layer in seq_along(layers_list)) {
do_pca(
set = 2,
time = layers_list[[layer]],
path_layer_stack = paste0(path_calibration, "/Calibration_area_", km),
#path_layer_proj = NULL,
path_layer_proj = paste0("data/layers/", layers_list[[layer]]),
sv_dir = paste0(path_calibration,"/pca_", km, "/", layers_list[[layer]]),
#sv_proj_dir = NULL,
sv_proj_dir = paste0(path_calibration,"/pca_", km, "/pca_proj_", layers_list[[layer]]),
nums = 1:5,
m_dir = paste0(path_calibration,"/Model_calibration/M_variables/Set_2"),
g_dir = NULL,
from_proj = FALSE
)
}
}
source("src/utils/libraries.R")
source("src/utils/functions.R")
data <- read_excel("data/selected_variables.xlsx") %>%
dplyr::mutate(across(2:6, char_to_list, .names = "{.col}"))
sp_name <- data$species
buffer_area_list <- colnames(data)[2:6]
buffer_area_list
data$species
colnames(data)[2:6]
source("src/utils/libraries.R")
source("src/utils/functions.R")
data <- read_excel("data/selected_variables.xlsx") %>%
dplyr::mutate(across(2:6, char_to_list, .names = "{.col}"))
sp_name <- data$species
buffer_area_list <- colnames(data)[2:6]
for (km in seq_along(buffer_area_list)) {
path_workflow <- paste0("data/workflow_maxent/")
path_calibration <- paste0(path_workflow, "/km_", buffer_area_list[[km]])
loc_variables <- data %>%
dplyr::filter(species == sp_name) %>%
dplyr::select(buffer_area_list[[km]])
flat_list <- as.numeric(unlist(loc_variables[[1]]))
print(flat_list)
dir_create(
paste0(
path_calibration,
"/G_variables"
)
)
dir_create(
paste0(
path_calibration, "/G_variables/Set_1"
)
)
dir_create(
paste0(
path_calibration, "/G_variables/Set_2"
)
)
layers_list <-
c(
"Current",
"future_layer_can_126_60", "future_layer_can_585_60",
"future_layer_mc_126_60", "future_layer_mc_585_60"
)
for (layer in seq_along(layers_list)) {
dir_create(
paste0(
path_calibration, "/G_variables/Set_1/", layers_list[[layer]]
)
)
file.copy(
from = paste0("data/bioclim_layer/CMIP6/", layers_list[[layer]], "/bio", flat_list, ".asc"),
to = paste0(path_calibration, "/G_variables/Set_1/", layers_list[[layer]], "/bio", flat_list, ".asc")
)
dir_create(
paste0(
path_calibration, "/G_variables/Set_2/", layers_list[[layer]]
)
)
pcs <- 1:5
file.copy(
from = paste0(path_calibration, "/pca_", buffer_area_list[[km]] , "/pca_proj_" , layers_list[[layer]], "/PC0", pcs, ".asc"),
to = paste0(path_calibration, "/G_variables/Set_2/", layers_list[[layer]], "/PC0", pcs, ".asc")
)
}
}
}
for (km in seq_along(buffer_area_list)) {
path_workflow <- paste0("data/workflow_maxent/")
path_calibration <- paste0(path_workflow, "/km_", buffer_area_list[[km]])
loc_variables <- data %>%
dplyr::filter(species == sp_name) %>%
dplyr::select(buffer_area_list[[km]])
flat_list <- as.numeric(unlist(loc_variables[[1]]))
print(flat_list)
dir_create(
paste0(
path_calibration,
"/G_variables"
)
)
dir_create(
paste0(
path_calibration, "/G_variables/Set_1"
)
)
dir_create(
paste0(
path_calibration, "/G_variables/Set_2"
)
)
layers_list <-
c(
"Current",
"future_layer_can_126_60", "future_layer_can_585_60",
"future_layer_mc_126_60", "future_layer_mc_585_60"
)
for (layer in seq_along(layers_list)) {
dir_create(
paste0(
path_calibration, "/G_variables/Set_1/", layers_list[[layer]]
)
)
file.copy(
from = paste0("data/bioclim_layer/CMIP6/", layers_list[[layer]], "/bio", flat_list, ".asc"),
to = paste0(path_calibration, "/G_variables/Set_1/", layers_list[[layer]], "/bio", flat_list, ".asc")
)
dir_create(
paste0(
path_calibration, "/G_variables/Set_2/", layers_list[[layer]]
)
)
pcs <- 1:5
file.copy(
from = paste0(path_calibration, "/pca_", buffer_area_list[[km]] , "/pca_proj_" , layers_list[[layer]], "/PC0", pcs, ".asc"),
to = paste0(path_calibration, "/G_variables/Set_2/", layers_list[[layer]], "/PC0", pcs, ".asc")
)
}
}
sp_name
loc_variables
buffer_area_list[[km]]
sp_name
loc_variables
flat_list <- as.numeric(unlist(loc_variables[[1]]))
print(flat_list)
dir_create(
paste0(
path_calibration,
"/G_variables"
)
)
dir_create(
paste0(
path_calibration, "/G_variables/Set_1"
)
)
dir_create(
paste0(
path_calibration, "/G_variables/Set_2"
)
)
layers_list <-
c(
"Current",
"future_layer_can_126_60", "future_layer_can_585_60",
"future_layer_mc_126_60", "future_layer_mc_585_60"
)
for (km in seq_along(buffer_area_list)) {
path_workflow <- paste0("data/workflow_maxent/")
path_calibration <- paste0(path_workflow, "/km_", buffer_area_list[[km]])
loc_variables <- data %>%
dplyr::filter(species == sp_name) %>%
dplyr::select(buffer_area_list[[km]])
flat_list <- as.numeric(unlist(loc_variables[[1]]))
print(flat_list)
dir_create(
paste0(
path_calibration,
"/G_variables"
)
)
dir_create(
paste0(
path_calibration, "/G_variables/Set_1"
)
)
dir_create(
paste0(
path_calibration, "/G_variables/Set_2"
)
)
layers_list <-
c(
"Current",
"future_layer_can_126_60", "future_layer_can_585_60",
"future_layer_mc_126_60", "future_layer_mc_585_60"
)
for (layer in seq_along(layers_list)) {
dir_create(
paste0(
path_calibration, "/G_variables/Set_1/", layers_list[[layer]]
)
)
file.copy(
from = paste0("data/layers/", layers_list[[layer]], "/bio", flat_list, ".asc"),
to = paste0(path_calibration, "/G_variables/Set_1/", layers_list[[layer]], "/bio", flat_list, ".asc")
)
dir_create(
paste0(
path_calibration, "/G_variables/Set_2/", layers_list[[layer]]
)
)
pcs <- 1:5
file.copy(
from = paste0(path_calibration, "/pca_", buffer_area_list[[km]] , "/pca_proj_" , layers_list[[layer]], "/PC0", pcs, ".asc"),
to = paste0(path_calibration, "/G_variables/Set_2/", layers_list[[layer]], "/PC0", pcs, ".asc")
)
}
}
